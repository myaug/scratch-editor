<!DOCTYPE html>
<html>
<head>
    <title>Block Level Testing</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .level-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .level-title { font-weight: bold; color: #333; margin-bottom: 10px; }
        .block-list { background: #f5f5f5; padding: 10px; border-radius: 3px; }
        .category { margin: 10px 0; }
        .category-title { font-weight: bold; color: #555; }
        .blocks { margin-left: 20px; color: #666; font-size: 14px; }
    </style>
</head>
<body>
    <h1>Block Level Configuration Test</h1>
    <p>This page tests the block filtering functionality for each level.</p>
    
    <div id="results"></div>
    
    <script type="module">
        // Import the block levels module
        import { BLOCK_LEVELS, getBlocksForLevel, LEVEL_DESCRIPTIONS } from './src/lib/block-levels.js';
        
        const resultsDiv = document.getElementById('results');
        
        // Test each level
        Object.values(BLOCK_LEVELS).forEach(level => {
            const levelDescription = LEVEL_DESCRIPTIONS[level];
            const allowedBlocks = getBlocksForLevel(level);
            
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'level-section';
            
            const title = document.createElement('div');
            title.className = 'level-title';
            title.innerHTML = `${levelDescription.icon} ${levelDescription.name} Level`;
            title.style.color = levelDescription.color;
            sectionDiv.appendChild(title);
            
            const description = document.createElement('div');
            description.innerHTML = levelDescription.description;
            description.style.fontStyle = 'italic';
            description.style.marginBottom = '15px';
            sectionDiv.appendChild(description);
            
            const blockListDiv = document.createElement('div');
            blockListDiv.className = 'block-list';
            
            Object.keys(allowedBlocks).forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';
                
                const categoryTitle = document.createElement('div');
                categoryTitle.className = 'category-title';
                categoryTitle.innerHTML = `${category.toUpperCase()}:`;
                categoryDiv.appendChild(categoryTitle);
                
                const blocksDiv = document.createElement('div');
                blocksDiv.className = 'blocks';
                blocksDiv.innerHTML = allowedBlocks[category].join(', ');
                categoryDiv.appendChild(blocksDiv);
                
                blockListDiv.appendChild(categoryDiv);
            });
            
            sectionDiv.appendChild(blockListDiv);
            resultsDiv.appendChild(sectionDiv);
        });
        
        // Test localStorage functionality
        const localStorageTest = document.createElement('div');
        localStorageTest.className = 'level-section';
        localStorageTest.innerHTML = `
            <div class="level-title">LocalStorage Test</div>
            <button onclick="testLocalStorage()">Test Level Storage</button>
            <div id="storage-results"></div>
        `;
        resultsDiv.appendChild(localStorageTest);
        
        window.testLocalStorage = async () => {
            const storageResults = document.getElementById('storage-results');
            try {
                // Import detect-level module
                const { getStoredLevel, setStoredLevel } = await import('./src/lib/detect-level.js');
                
                // Test setting and getting different levels
                const results = [];
                for (const level of Object.values(BLOCK_LEVELS)) {
                    setStoredLevel(level);
                    const retrieved = getStoredLevel();
                    results.push(`Set: ${level}, Retrieved: ${retrieved}, Match: ${level === retrieved ? '✅' : '❌'}`);
                }
                
                storageResults.innerHTML = `<div style="margin-top: 10px;">${results.join('<br>')}</div>`;
            } catch (error) {
                storageResults.innerHTML = `<div style="color: red; margin-top: 10px;">Error: ${error.message}</div>`;
            }
        };
    </script>
</body>
</html>
